start time: 2022-10-14 12:45:13
loading data...
snli_1.0_train.jsonl loaded succcess, 549367 in total.
snli_1.0_dev.jsonl loaded succcess, 9842 in total.
snli_1.0_test.jsonl loaded succcess, 9824 in total.
Time used: 0:00:12
ESIM(
  (embedding): Embedding(400003, 600, padding_idx=400002)
  (encoding): LSTM(600, 600, batch_first=True, bidirectional=True)
  (composition): LSTM(4800, 600, batch_first=True, bidirectional=True)
  (mlp): Sequential(
    (0): Dropout(p=0.3, inplace=False)
    (1): Linear(in_features=4800, out_features=600, bias=True)
    (2): Tanh()
    (3): Linear(in_features=600, out_features=3, bias=True)
  )
)
Epoch [1/20]
Iter:   1000,  Train Loss:   1.0,  Train Acc: 48.44%,  Val Loss:  0.98,  Val Acc: 55.41%,  Time: 0:03:25*
Iter:   2000,  Train Loss:  0.92,  Train Acc: 60.94%,  Val Loss:  0.95,  Val Acc: 58.23%,  Time: 0:06:56*
Iter:   3000,  Train Loss:  0.92,  Train Acc: 64.06%,  Val Loss:  0.94,  Val Acc: 59.43%,  Time: 0:10:27*
Iter:   4000,  Train Loss:  0.95,  Train Acc: 60.94%,  Val Loss:  0.93,  Val Acc: 60.50%,  Time: 0:13:57*
Iter:   5000,  Train Loss:  0.91,  Train Acc: 65.62%,  Val Loss:  0.93,  Val Acc: 60.81%,  Time: 0:17:29*
Iter:   6000,  Train Loss:  0.94,  Train Acc: 60.94%,  Val Loss:  0.92,  Val Acc: 61.73%,  Time: 0:21:01*
Iter:   7000,  Train Loss:  0.95,  Train Acc: 59.38%,  Val Loss:  0.91,  Val Acc: 62.61%,  Time: 0:24:33*
Iter:   8000,  Train Loss:  0.93,  Train Acc: 60.94%,  Val Loss:  0.91,  Val Acc: 62.83%,  Time: 0:28:06*
Iter:   8584,  Train Loss:  0.98,  Train Acc: 52.73%,  Val Loss:   0.9,  Val Acc: 63.25%,  Time: 0:30:19*
Epoch [2/20]
Iter:   9000,  Train Loss:  0.87,  Train Acc: 68.75%,  Val Loss:   0.9,  Val Acc: 63.62%,  Time: 0:31:58*
Iter:  10000,  Train Loss:  0.82,  Train Acc: 73.44%,  Val Loss:   0.9,  Val Acc: 63.82%,  Time: 0:35:33*
Iter:  11000,  Train Loss:  0.94,  Train Acc: 59.38%,  Val Loss:   0.9,  Val Acc: 64.01%,  Time: 0:39:08*
Iter:  12000,  Train Loss:  0.91,  Train Acc: 65.62%,  Val Loss:  0.89,  Val Acc: 64.57%,  Time: 0:42:46*
Iter:  13000,  Train Loss:  0.95,  Train Acc: 59.38%,  Val Loss:  0.89,  Val Acc: 64.47%,  Time: 0:46:20*
Iter:  14000,  Train Loss:  0.94,  Train Acc: 57.81%,  Val Loss:  0.89,  Val Acc: 64.99%,  Time: 0:49:50*
Iter:  15000,  Train Loss:  0.84,  Train Acc: 71.88%,  Val Loss:  0.89,  Val Acc: 64.63%,  Time: 0:53:11
Iter:  16000,  Train Loss:   0.9,  Train Acc: 62.50%,  Val Loss:  0.89,  Val Acc: 64.84%,  Time: 0:56:42*
Iter:  17000,  Train Loss:  0.91,  Train Acc: 65.62%,  Val Loss:  0.88,  Val Acc: 65.57%,  Time: 1:00:10*
Iter:  17168,  Train Loss:  0.86,  Train Acc: 69.09%,  Val Loss:  0.88,  Val Acc: 65.46%,  Time: 1:00:50
Epoch [3/20]
Iter:  18000,  Train Loss:  0.85,  Train Acc: 70.31%,  Val Loss:  0.88,  Val Acc: 65.88%,  Time: 1:03:47*
Iter:  19000,  Train Loss:  0.91,  Train Acc: 62.50%,  Val Loss:  0.88,  Val Acc: 66.04%,  Time: 1:07:15*
Iter:  20000,  Train Loss:  0.86,  Train Acc: 67.19%,  Val Loss:  0.88,  Val Acc: 66.18%,  Time: 1:10:43*
Iter:  21000,  Train Loss:  0.81,  Train Acc: 75.00%,  Val Loss:  0.88,  Val Acc: 66.29%,  Time: 1:14:12*
Iter:  22000,  Train Loss:  0.75,  Train Acc: 79.69%,  Val Loss:  0.87,  Val Acc: 66.47%,  Time: 1:17:43*
Iter:  23000,  Train Loss:  0.83,  Train Acc: 71.88%,  Val Loss:  0.87,  Val Acc: 66.93%,  Time: 1:21:15*
Iter:  24000,  Train Loss:  0.84,  Train Acc: 67.19%,  Val Loss:  0.88,  Val Acc: 66.27%,  Time: 1:24:35
Iter:  25000,  Train Loss:  0.86,  Train Acc: 67.19%,  Val Loss:  0.87,  Val Acc: 66.94%,  Time: 1:28:06*
Iter:  25752,  Train Loss:  0.92,  Train Acc: 61.82%,  Val Loss:  0.87,  Val Acc: 67.22%,  Time: 1:30:48*
Epoch [4/20]
Iter:  26000,  Train Loss:  0.84,  Train Acc: 71.88%,  Val Loss:  0.87,  Val Acc: 67.33%,  Time: 1:31:52*
Iter:  27000,  Train Loss:  0.83,  Train Acc: 70.31%,  Val Loss:  0.87,  Val Acc: 67.39%,  Time: 1:35:13
Iter:  28000,  Train Loss:  0.91,  Train Acc: 62.50%,  Val Loss:  0.87,  Val Acc: 67.24%,  Time: 1:38:45*
Iter:  29000,  Train Loss:  0.94,  Train Acc: 56.25%,  Val Loss:  0.87,  Val Acc: 67.24%,  Time: 1:42:06
Iter:  30000,  Train Loss:  0.78,  Train Acc: 76.56%,  Val Loss:  0.86,  Val Acc: 67.60%,  Time: 1:45:37*
Iter:  31000,  Train Loss:  0.84,  Train Acc: 71.88%,  Val Loss:  0.86,  Val Acc: 67.94%,  Time: 1:49:07*
Iter:  32000,  Train Loss:  0.98,  Train Acc: 53.12%,  Val Loss:  0.86,  Val Acc: 67.91%,  Time: 1:52:36*
Iter:  33000,  Train Loss:  0.84,  Train Acc: 70.31%,  Val Loss:  0.86,  Val Acc: 67.61%,  Time: 1:55:56
Iter:  34000,  Train Loss:   0.8,  Train Acc: 75.00%,  Val Loss:  0.86,  Val Acc: 68.10%,  Time: 1:59:26*
Iter:  34336,  Train Loss:  0.83,  Train Acc: 70.91%,  Val Loss:  0.86,  Val Acc: 68.06%,  Time: 2:00:46*
Epoch [5/20]
Iter:  35000,  Train Loss:  0.85,  Train Acc: 71.88%,  Val Loss:  0.86,  Val Acc: 67.84%,  Time: 2:03:02
Iter:  36000,  Train Loss:  0.84,  Train Acc: 70.31%,  Val Loss:  0.86,  Val Acc: 68.10%,  Time: 2:06:30
Iter:  37000,  Train Loss:  0.91,  Train Acc: 64.06%,  Val Loss:  0.86,  Val Acc: 67.84%,  Time: 2:09:56
Iter:  38000,  Train Loss:  0.84,  Train Acc: 73.44%,  Val Loss:  0.86,  Val Acc: 67.95%,  Time: 2:13:23
Iter:  39000,  Train Loss:  0.79,  Train Acc: 78.12%,  Val Loss:  0.86,  Val Acc: 68.36%,  Time: 2:17:00*
Iter:  40000,  Train Loss:  0.84,  Train Acc: 70.31%,  Val Loss:  0.86,  Val Acc: 68.09%,  Time: 2:20:30
Iter:  41000,  Train Loss:  0.87,  Train Acc: 68.75%,  Val Loss:  0.85,  Val Acc: 68.45%,  Time: 2:24:05*
Iter:  42000,  Train Loss:  0.92,  Train Acc: 60.94%,  Val Loss:  0.86,  Val Acc: 68.22%,  Time: 2:27:27
Iter:  42920,  Train Loss:  0.85,  Train Acc: 65.45%,  Val Loss:  0.86,  Val Acc: 68.42%,  Time: 2:30:37
Epoch [6/20]
Iter:  43000,  Train Loss:  0.79,  Train Acc: 75.00%,  Val Loss:  0.85,  Val Acc: 68.95%,  Time: 2:31:10*
Iter:  44000,  Train Loss:  0.73,  Train Acc: 82.81%,  Val Loss:  0.85,  Val Acc: 68.43%,  Time: 2:34:33
Iter:  45000,  Train Loss:  0.85,  Train Acc: 70.31%,  Val Loss:  0.85,  Val Acc: 68.80%,  Time: 2:37:56
Iter:  46000,  Train Loss:  0.83,  Train Acc: 70.31%,  Val Loss:  0.86,  Val Acc: 68.51%,  Time: 2:41:17
Iter:  47000,  Train Loss:  0.89,  Train Acc: 65.62%,  Val Loss:  0.86,  Val Acc: 68.45%,  Time: 2:44:36
Iter:  48000,  Train Loss:  0.86,  Train Acc: 68.75%,  Val Loss:  0.85,  Val Acc: 68.55%,  Time: 2:47:56
Iter:  49000,  Train Loss:  0.85,  Train Acc: 71.88%,  Val Loss:  0.85,  Val Acc: 68.86%,  Time: 2:51:23*
Iter:  50000,  Train Loss:   0.8,  Train Acc: 75.00%,  Val Loss:  0.85,  Val Acc: 68.79%,  Time: 2:54:40
Iter:  51000,  Train Loss:  0.88,  Train Acc: 67.19%,  Val Loss:  0.85,  Val Acc: 68.53%,  Time: 2:57:59
Iter:  51504,  Train Loss:  0.86,  Train Acc: 67.27%,  Val Loss:  0.85,  Val Acc: 68.84%,  Time: 2:59:42
Epoch [7/20]
Iter:  52000,  Train Loss:  0.79,  Train Acc: 75.00%,  Val Loss:  0.85,  Val Acc: 69.07%,  Time: 3:01:33*
Iter:  53000,  Train Loss:  0.87,  Train Acc: 68.75%,  Val Loss:  0.85,  Val Acc: 69.15%,  Time: 3:05:00*
Iter:  54000,  Train Loss:  0.85,  Train Acc: 67.19%,  Val Loss:  0.85,  Val Acc: 68.94%,  Time: 3:08:17
Iter:  55000,  Train Loss:  0.76,  Train Acc: 81.25%,  Val Loss:  0.85,  Val Acc: 68.93%,  Time: 3:11:35
Iter:  56000,  Train Loss:  0.92,  Train Acc: 62.50%,  Val Loss:  0.85,  Val Acc: 69.26%,  Time: 3:15:01*
Iter:  57000,  Train Loss:  0.81,  Train Acc: 71.88%,  Val Loss:  0.85,  Val Acc: 69.25%,  Time: 3:18:18
Iter:  58000,  Train Loss:  0.88,  Train Acc: 67.19%,  Val Loss:  0.85,  Val Acc: 69.02%,  Time: 3:21:36
Iter:  59000,  Train Loss:  0.75,  Train Acc: 79.69%,  Val Loss:  0.85,  Val Acc: 69.28%,  Time: 3:25:03*
Iter:  60000,  Train Loss:  0.87,  Train Acc: 65.62%,  Val Loss:  0.85,  Val Acc: 69.15%,  Time: 3:28:20
Iter:  60088,  Train Loss:  0.76,  Train Acc: 78.18%,  Val Loss:  0.85,  Val Acc: 69.58%,  Time: 3:28:54*
Epoch [8/20]
Iter:  61000,  Train Loss:  0.78,  Train Acc: 78.12%,  Val Loss:  0.85,  Val Acc: 68.96%,  Time: 3:31:54
Iter:  62000,  Train Loss:   0.9,  Train Acc: 62.50%,  Val Loss:  0.85,  Val Acc: 69.14%,  Time: 3:35:12
Iter:  63000,  Train Loss:  0.75,  Train Acc: 78.12%,  Val Loss:  0.85,  Val Acc: 69.11%,  Time: 3:38:30
Iter:  64000,  Train Loss:  0.82,  Train Acc: 68.75%,  Val Loss:  0.85,  Val Acc: 68.99%,  Time: 3:41:48
Iter:  65000,  Train Loss:  0.86,  Train Acc: 65.62%,  Val Loss:  0.85,  Val Acc: 69.39%,  Time: 3:45:06
Iter:  66000,  Train Loss:  0.74,  Train Acc: 81.25%,  Val Loss:  0.85,  Val Acc: 69.52%,  Time: 3:48:25
Iter:  67000,  Train Loss:  0.79,  Train Acc: 78.12%,  Val Loss:  0.85,  Val Acc: 69.11%,  Time: 3:51:43
Iter:  68000,  Train Loss:  0.85,  Train Acc: 68.75%,  Val Loss:  0.85,  Val Acc: 69.28%,  Time: 3:55:05
Iter:  68672,  Train Loss:  0.92,  Train Acc: 63.64%,  Val Loss:  0.85,  Val Acc: 69.47%,  Time: 3:57:23
Epoch [9/20]
Iter:  69000,  Train Loss:  0.78,  Train Acc: 76.56%,  Val Loss:  0.85,  Val Acc: 69.08%,  Time: 3:58:35
Iter:  70000,  Train Loss:  0.78,  Train Acc: 78.12%,  Val Loss:  0.85,  Val Acc: 69.31%,  Time: 4:01:57
No optimization for a long time, auto-stopping...
Confusion Matrix...
[[2180  427  612]
 [ 563 2077  597]
 [ 529  275 2564]]
Precision, Recall and F1-Score...
               precision    recall  f1-score   support

      neutral     0.6663    0.6772    0.6717      3219
contradiction     0.7474    0.6416    0.6905      3237
   entailment     0.6796    0.7613    0.7181      3368

     accuracy                         0.6943      9824
    macro avg     0.6977    0.6934    0.6934      9824
 weighted avg     0.6976    0.6943    0.6938      9824

Test Loss:  0.85,  Test Acc: 69.43%
Time usage: 0:00:08

